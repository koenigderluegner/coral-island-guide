<app-list-detail-container>
    <ng-container listDetail>
        @if (selectedEntity) {
            <app-mail-details [mail]="selectedEntity"/>
        }
        @if (selectedTornPage) {
            <app-torn-page-details [tornPage]="selectedTornPage"/>
        }

        @if (selectedTreasureHunt) {
            <app-card class="text-lg font-semibold relative">
                <div cardActions class="card-actions">
                    <button (click)="listDetail.close()" matTooltip="Close">
                        <app-ui-icon [uiIcon]="uiIcon.CROSS"
                                     class="!w-8 !h-8 hover:text-black focus-visible:text-black"/>
                    </button>
                </div>
                <app-full-size-image class="full-size-card-image image-only" hasThumb
                                     [imageName]="'treasure-maps/'+selectedTreasureHunt.mapImage"/>


            </app-card>
        }

    </ng-container>
    @if (data$ | async) {
        <mat-tab-group (selectedTabChange)="updateUrl($event)" [selectedIndex]="selectedTabIndex()">
            <mat-tab [label]="tabNames[0]">
                <app-data-filter [(showTable)]="showTable"/>
                @if (!showTable) {
                    <div class="icon-grid mt-3">
                        @for (mail of mails; track mail) {
                            <app-item-icon (click)="showDetails(mail)"

                                           [class.selected-icon]="selectedEntity?.key === mail.key"
                                           class="icon-grid-item"
                                           itemName="Torn_page">
                            </app-item-icon>
                        }
                    </div>
                }
                @if (showTable) {
                    <app-mail-table [dataSource]="mails"/>
                }

            </mat-tab>
            <mat-tab [label]="tabNames[1]">
                <app-data-filter [(showTable)]="showTornPagesTable"/>
                @if (!showTornPagesTable) {
                    <div class="icon-grid mt-3">
                        @for (tornPage of tornPages; track tornPage) {
                            <app-item-icon (click)="showTornPageDetails(tornPage)"

                                           [class.selected-icon]="selectedTornPage?.key === tornPage.key"
                                           class="icon-grid-item"
                                           itemName="Torn_page">
                            </app-item-icon>
                        }
                    </div>
                }
                @if (showTornPagesTable) {
                    <app-torn-pages-table [dataSource]="tornPages"/>
                }

            </mat-tab>
            <mat-tab [label]="tabNames[2]">

                <div class="icon-grid mt-3">
                    @for (tornPage of treasureMaps; track tornPage) {
                        <app-item-icon (click)="showTreasureDetails(tornPage)"

                                       [class.selected-icon]="selectedTreasureHunt?.treasureId === tornPage.treasureId"
                                       class="icon-grid-item"
                                       [itemName]="tornPage.iconName">
                        </app-item-icon>
                    }
                </div>


            </mat-tab>


        </mat-tab-group>
    }


</app-list-detail-container>
