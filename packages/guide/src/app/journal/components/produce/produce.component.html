<app-list-detail-container [(openDrawer)]="openDrawer">
    <app-produce-details *ngIf="selectedEntity" [item]="selectedEntity" listDetail/>

    <mat-tab-group (selectedTabChange)="updateUrl($event)" [selectedIndex]="selectedTabIndex"
                   class=" px-2 xl:px-[50px] w-full"
                   mat-stretch-tabs="false">
        <mat-tab [label]="tab.title" *ngFor="let tab of tabs">

            <app-data-filter [(showTable)]="showTable" [parentFormGroup]="formControl"/>
            <ng-container *ngIf="(tab.data |async) as syncedData">
                <div *ngIf="!showTable" class="grid gap-4 icon-grid">
                    <ng-container *ngFor="let entry of syncedData">
                        <app-item-icon (click)="showDetails(entry)"
                                       [itemName]="(entry | isItem) ? entry.iconName : entry.dropData[0].item?.iconName"
                                       [class.selected-icon]="((selectedEntity | isItem) ? selectedEntity.id : selectedEntity?.dropData?.[0]?.item?.id) === ((entry | isItem) ? entry.id : entry.dropData[0].item?.id)"
                                       class="icon-grid-item"
                        />
                    </ng-container>
                </div>

                <ng-container *ngIf="showTable">

                    <app-non-specialized-table *ngIf="tab.title !== tabs[0].title"
                                               [dataSource]="castToItemArray(syncedData)"/>
                    <app-crop-table *ngIf="tab.title === tabs[0].title" [dataSource]="castToBaseCropArray(syncedData)"/>
                </ng-container>
            </ng-container>

        </mat-tab>
    </mat-tab-group>
</app-list-detail-container>
