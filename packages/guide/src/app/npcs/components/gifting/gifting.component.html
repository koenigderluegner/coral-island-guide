<div class="px-2 xl:px-[50px] w-full pt-2 pb-6 2xl:pt-[60px]">
    <app-npc-filter/>

    @if (gifting$  | async; as gifting) {
        <app-card class="text-xl gifting-card">

            @for (giftingPreferences of filteredAndSortedNpcs(); track giftingPreferences) {

                <app-expandable #expandableComponent open class="mb-8">
                    <div class="flex justify-between items-center cursor-pointer" expandableHeader
                         (click)="expandableComponent.toggle()">
                        <div class="text-2xl text-black font-semibold flex items-center gifting-portrait">
                            @if (giftingPreferences.preferences.npc) {

                                <app-item-icon class="h-16 mr-3"
                                               [itemName]="giftingPreferences.preferences.npc.iconName"></app-item-icon>
                                <div class="flex flex-col">
                                    <div class="flex gap-2 items-center"> {{ giftingPreferences.preferences.npc.characterName }}
                                        @if (giftingPreferences.npc?.isDateable) {
                                            <app-ui-icon
                                                    [uiIcon]="uiIcon.LOVE" class="!text-gifting !h-6 !w-6"
                                                    matTooltip="{{giftingPreferences.npc?.characterName}} is dateable"/>
                                        }
                                    </div>
                                    @if (giftingPreferences.npc && giftingPreferences.npc.birthday) {
                                        <div
                                                class="text-lg flex gap-2">
                                            <app-ui-icon [uiIcon]="uiIcon.BIRTHDAY" class="!h-6 !w-6"/>
                                            {{ giftingPreferences.npc.birthday | ingameDate }}
                                        </div>
                                    }
                                </div>

                            }
                            @if (giftingPreferences.preferences.mapKey === 'ci_universal') {
                                Universal
                            }

                        </div>

                        <i [class.down]="!expandableComponent.open"
                           [class.translate-y-[-3px]]="expandableComponent.open"
                           [class.up]="expandableComponent.open" class="arrow"></i>

                    </div>
                    <app-gifting-grid [preferences]="giftingPreferences.preferences"/>

                </app-expandable>
            }


        </app-card>
    }
</div>
